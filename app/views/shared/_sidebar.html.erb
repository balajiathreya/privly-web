<!--
These page items are explicitly included by hash values set in the controller
For example, when @sidebar[:post] evaluates to true, the post sidebar will be
included.
-->
<script type="text/javascript">
    $(function() {
        //creates the jquery UI based sidebar
        if($( "#sidebar_accordion" ).length !== 0)
        {
            $( "#sidebar_accordion" ).accordion({autoHeight: false,
                collapsible: true});
        }
        //fill the starting values if it is defined
        if($("#urlOptionsForm").length !== 0)
        {
            fillFormStartingValues();
            updateURL();
        }
        //Expand the news accorion on page load
        if( $("#in_the_news").length !== 0 )
        {
          $("#in_the_news").trigger('click');
        }
    });
</script>

<% if @sidebar %>
<div id="sidebar">
    <div id="sidebar_accordion">
        
        <%# Show the context menus for a particular post %>
        <% if @sidebar[:post] %>
          <h2 id="post_info_sidebar"><a>Post Info</a></h2>
          <div>
              <ul class="posts">
                  <% if @post.burn_after_date %>
                      <% if @post.burn_after_date > Time.now %>
                          <li>
                              <a>
                                  Destroyed in 
                                  <%= time_ago_in_words(
                                      @post.burn_after_date) %>
                              </a>
                          </li>
                      <% end %>
                  <% else %>
                      <li><a>No Destroy Date Set</a></li>
                  <% end %>
                  <% if user_signed_in? %>
                      <% if current_user == @post.user %>
                          <li><a>You Own This</a></li>
                          <li>
                              <a class="date">
                                  Posted 
                                  <%= time_ago_in_words(@post.created_at) %> ago.
                              </a>
                          </li>
                      <% else %>
                          <li><a>You Don't Own This</a></li>
                      <% end %>
                  <% else %>
                      <li>
                          <%= link_to "log in for ownership information",
                              new_user_session_url %>
                      </li>
                  <% end %>
                  
                  <% if @post.public %>
                      <li><a>Public Post</a></li>
                      <% if can? :update, @post and can? :share, @post %>
                        <li><a>
                          <%= form_for(@post) do |f| %>
                            <%= f.hidden_field(:public, {:value=>0}) %>
                            <%= f.submit "Make Private" %>
                            <%= hidden_field_tag :random_token, @post.random_token %>
                          <% end %>
                        </a></li>
                      <% end %>
                  <% else %>
                      <li><a>Private Post</a></li>
                      <% if can? :update, @post and can? :share, @post %>
                        <li><a>
                          <%= form_for(@post) do |f| %>
                            <%= f.hidden_field(:public, {:value=>1}) %>
                            <%= hidden_field_tag :random_token, @post.random_token %>
                            <%= f.submit "Make Public" %>
                          <% end %>
                        </a></li>
                      <% end %>
                  <% end %>
              </ul>
          </div>
        <% end %><%# @sidebar[:post] %>
        
        <% if @sidebar[:link_options] and (@post.content or not @post.structured_content) %>
        
          <%# Build link options for embedding elsewhere %>
          <h2 id="link_options_sidebar"><a>Link Options</a></h2>
          <div id="urlOptionsForm">
              <ul class="posts">
                <p>Link options change the way links are displayed on pages you post links to. When you update these options, the link to the left will change to reflect your changes. Copy the updated link to pages you are sharing on. This information is not stored by Privly.</p>
                <%= form_tag nil, :id => "linkFormatterForm" do %>
                    <li>
                        Burn Message
                        <%= text_field_tag(:privlyBurnMessage, nil,
                            {:onkeyup=>"updateURL();", :use_in_url=>"true"}) %>
                    </li>
                    <li>
                        Passive Message
                        <%= text_field_tag(:privlyPassiveMessage, nil,
                            {:onkeyup=>"updateURL();", :use_in_url=>"true"}) %>
                    </li>
                    <li>
                        Force Passive?
                        <%= check_box_tag(:privlyPassive, "true", false,
                            {:onclick=>"updateURL();", :use_in_url=>"true"}) %>
                    </li>
                    <li>
                        Exclude from Replacement?
                        <%= check_box_tag(:privlyExclude, "true", false,
                            {:onclick=>"updateURL();", :use_in_url=>"true"}) %>
                    </li>
                    <%= hidden_field_tag(:privlyInject1, "true", 
                      {:use_in_url=>"true"}) %>
                <% end %>
              </ul>
          </div>
        <% end %><%# @sidebar[:link_options] %>
        
        <%# Create new content menus %>
        <% if @sidebar[:posts] %>
        <h2 id="posting_apps_sidebar"><a>Posting Apps</a></h2>
        <div>
          <% if user_signed_in? and current_user.can_post %>
            <p>Since you are logged into an account with posting permission, your posts will be tied to your user account and accessible without needing the original link.</p>
            <ul class="posts">
                <li><%= link_to 'New ZeroBin', '/zero_bin/' %> ZeroBin encrypts content in your browser before sending it to a server for storage. You can decide who has access to the encrypted content, but no one can read the content without the link you generate (including you). The decryption key is never sent to the storage server.</li>
                <li><%= link_to 'New Post', new_post_path %> Posts are cleartext (not encrypted) content. Anyone with access to the content on the server will be able to read your content. Posts support the Markdown format, and are readable by content owners without the original link.</li>
            </ul>
          <% else %>
            <p>An anonymous post is content that is not tied to any user account. All anonymous posts are destroyed within two days. Testers, developer, and backers can get access to user posts, which are posts tied to user accounts.</p>
            <ul class="posts">
                <li><%= link_to 'New Anonymous ZeroBin', '/zero_bin/' %> ZeroBin encrypts content in your browser before sending it to a server for storage. You can decide who has access to the encrypted content, but no one can read the content without the link you generate (including you). The decryption key is never sent to the storage server.</li>
                <li><%= link_to 'New Anonymous Post', new_post_path %> Posts are cleartext (not encrypted) content. Anyone with access to the content on the server will be able to read your content. Posts support the Markdown format.</li>
            </ul>
          <% end %>
            
        </div>
        <% end %><%# @sidebar[:posts] %>
        
        <%# Markdown format cheat sheet %>
        <% if @sidebar[:markdown] %>
        <h2 id="markdown_sidebar">
            <a>
                Markdown Tips
            </a>
        </h2>
        <div>
            <p>If you add the symbols shown below to the text you write, it will change how your text is displayed.</p>
            <ul class="posts">
                <li><em>*Emphasis*</em></li>
                <li><strong>**Strong**</strong></li>
                <li>[link text here](link.address.here "link title here")</li>
                <li>Line Break: a line ending in two spaces.</li>
                <li>1. An ordered list</li>
                <li>* An unordered list</li>
                <li>`<code>code</code>`</li>
                <li><h1># heading</h1></li>
                <li><h2>## subheading</h2></li>
                <li><h3>### sub-subheading</h3></li>
                <li>
                    <%= link_to "More on Markdown", 
                        "http://en.wikipedia.org/wiki/Markdown",
                        {:target => "_blank"} %>
                </li>
            </ul>
        </div>
        <% end %><%# @sidebar[:markdown] %>
        
        <%# About the Site Menu %>
        <% if @sidebar[:about] or @sidebar[:contribute] %>
        <h2 id="sidebar_about_1"><a>Privly Resources</a></h2>
        <div>
            <ul class="posts">
                <li><%= link_to "About", pages_about_path %></li>
                <li><%= link_to "FAQ", pages_faq_path %></li>
                <li>
                    <%= link_to "Download Extension", pages_download_path %>
                </li>
                <li><%= link_to "Donate", pages_donate_path %></li>
                <li><%= link_to "Tester Email List", "https://groups.google.com/forum/?fromgroups#!forum/privly-test" %></li>
            </ul>
        </div>
        
        <h2 id="sidebar_about_2"><a>Privly Development</a></h2>
        <div>
            <ul class="posts">
                <li><%= link_to "Development Site", pages_join_path %></li>
                <li><%= link_to "License", pages_privacy_path %></li>
                <li><%= link_to "Submit a Bug", pages_bug_path %></li>
                <li><%= link_to "Development Email List", pages_email_path %></li>
                <li><%= link_to "Wiki", "https://github.com/privly/privly-organization/wiki" %></li>
                <li><%= link_to "IRC", pages_irc_path %></li>
            </ul>
        </div>
        
        <% end %><%# @sidebar[:about] %>
        
        <%# Show site news %>
        <% if @sidebar[:news] %>
        <h2 id="sidebar_news"><a>Site News</a></h2>
        <div>
            <ul class="menu">
                <li><%= link_to "Privly Twitter", 
                    "http://twitter.com/#!/Privly" %></li>
            </ul>
        </div>
        <% end %><%# @sidebar[:news] %>
        
        <%# List of Privly Articles %>
        <% if @sidebar[:in_the_news] %>
        <h2 id="in_the_news"><a>Privly Gets Press Attention</a></h2>
        <div>
          <p>
            <%= link_to image_tag("NewsSites/atlantic_logo.gif", :width=>230), "http://www.theatlantic.com/technology/archive/12/04/a-privacy-manifesto-in-code-what-if-your-emails-never-went-to-gmail-and-twitter-couldnt-see-your-tweets/255414/" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/Spiegel_Online_logo.png", :width=>230), "http://www.spiegel.de/netzwelt/web/0,1518,825950,00.html" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/wired_logo.gif", :width=>230), "http://www.wired.co.uk/magazine/archive/2012/09/ideas-bank/how-not-to-be-a-product-on-facebook" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/Mashable_Logo_230px.png", :width=>230), "http://mashable.com/2012/04/04/privly/" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/technabob_240_90_logo_black.gif", :width=>230), "http://technabob.com/blog/2012/03/25/privly-content-proetection/" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/omnitechnews.jpg", :width=>230), "http://www.omnitechnews.net/2012/03/29/privly/" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/TweakTown.png", :width=>230), "http://www.tweaktown.com/news/23408/priv_ly_wants_to_give_privacy_back_to_users_acts_as_invisible_web_link/index.html" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/GMMNewHeader.png", :width=>230), "http://www.givememind.com/priv-ly-protect-your-content-anywhere-on-the-web/" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/DigitalTrends.png", :width=>230), "http://www.digitaltrends.com/web/for-your-eyes-only-privly-acts-like-invisible-ink-for-the-web/" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/FutureZone.png", :width=>230), "http://futurezone.at/produkte/8392-priv-ly-verschluesselung-fuer-soziale-netzwerke.php" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/ExtendedLimits.png", :width=>230), "http://www.extendlimits.nl/nieuws/artikel/priv.ly_kan_onze_privacy_terugbrengen/" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/osu-tag.gif"), "http://eecs.oregonstate.edu/people/meet-our-students/privly" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/yc500.gif", :width=>230), "http://news.ycombinator.com/item?id=3799542" %>
            <br/>
            <br/>
            <%= link_to image_tag("NewsSites/techli.jpg", :width=>230), "http://tech.li/2012/04/encryption-extension-privly/" %>
            <br/>
            <br/>
            <%= link_to "Barrapunto (Spanish)", "http://barrapunto.com/articles/12/04/06/0852236.shtml" %>
            <br/>
            <br/>
            <%= link_to "Hacker10", "http://www.hacker10.com/computer-security/share-encrypted-messages-on-social-networks-with-privly/" %>
            <br/>
            <br/>
            <%= link_to "TheBlaze", "http://www.theblaze.com/stories/dont-want-facebook-to-read-your-messages-meet-the-start-up-making-communications-100-percent-private/" %>
            <br/>
            <br/>
            <%= link_to "Tech the Future", "http://www.techthefuture.com/technology/game-changing-browser-extension-anonymizes-your-web-activity/" %>
            <br/>
            <br/>
            <%= link_to "Social Media Club (German)", " http://www.socialmediaclub.at/2012/04/alternative-fur-datenschutz.html" %>
            <br/>
            <br/>
          </p>
        </div>
        <% end %><%# @sidebar[:in_the_news] %>
    </div><!-- End of Accordion -->
</div>
<% end %>